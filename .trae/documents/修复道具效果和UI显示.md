## 问题分析

1. **策略指引**：虽然生成了推荐位置，但可能没有正确设置游戏子状态或在落子后没有正确清除指引
2. **手滑惩罚**：虽然限制了落子位置，但渲染器没有绘制这些允许落子的位置
3. **精准打击**：虽然设置了选择目标的子状态，但渲染器没有处理这个状态，没有给玩家反馈
4. **对手加速**：虽然设置了对手额外落子的标志，但可能没有正确处理

## 修复计划

### 1. 策略指引修复

* **修改** **`CanvasRenderer.ts`**：确保 `drawStrategyGuide` 方法正确绘制指引位置

* **检查** **`GomokuGame.ts`**：确保 `showStrategyGuide` 方法正确设置游戏子状态

* **验证** **`makeMove`** **方法**：确保在落子后正确清除策略指引和子状态

### 2. 手滑惩罚修复

* **修改** **`CanvasRenderer.ts`**：添加 `drawSlipPenalty` 方法，绘制允许落子的位置

* **修改** **`drawStones`** **方法**：调用 `drawSlipPenalty` 方法

* **添加** **`getAllowedPositions`** **方法**：在 `GomokuGame.ts` 中添加该方法，让渲染器可以获取允许落子的位置

### 3. 精准打击修复

* **修改** **`CanvasRenderer.ts`**：添加 `drawPreciseStrikeMode` 方法，绘制可以选择的对手棋子

* **修改** **`drawStones`** **方法**：调用 `drawPreciseStrikeMode` 方法

* **检查** **`makeMove`** **方法**：确保正确处理 `SELECTING_STRIKE_TARGET` 状态，允许玩家选择要移除的棋子

### 4. 对手加速修复

* **检查** **`GomokuGame.ts`**：确保 `makeMove` 方法正确处理 `opponentHasExtraMove` 标志

* **添加反馈机制**：在状态栏或UI中显示对手获得了额外的落子机会

## 实现步骤

1. **添加必要的 getter 方法**：在 `GomokuGame.ts` 中添加 `getAllowedPositions` 方法
2. **修改渲染器**：在 `CanvasRenderer.ts` 中添加新的绘制方法
3. **更新绘制流程**：在 `drawStones` 方法中调用新添加的绘制方法
4. **测试和验证**：确保所有道具效果都能正确工作

## 预期效果

1. **策略指引**：在棋盘上显示3个由系统推荐的最优落子位置，落子后移除
2. **手滑惩罚**：在棋盘上标记出可以落子的3个位置，玩家只能在这些位置中选择
3. **精准打击**：进入特殊选择模式，玩家可以点击选择要移除的对手棋子
4. **对手加速**：对手获得额外的落子机会，UI显示相关信息

## 技术细节

* 使用 Canvas 绘制视觉反馈

* 通过游戏状态管理道具效果

* 确保状态切换的正确性

* 提供清晰的用户反馈

